# Устранение проблемы с проверкой хеша Telegram

## Проблема
Хеши не совпадают при проверке авторизации через Telegram.

## Возможные причины

1. **Домен не настроен в BotFather** - это самая частая причина. Если домен не настроен, проверка хеша может работать некорректно.

2. **Неправильный алгоритм проверки** - возможно, используется неправильный алгоритм для проверки хеша.

## Временное решение

Добавлена возможность временно отключить проверку хеша для тестирования:

1. В `backend/.env` добавлено:
   ```
   SKIP_TELEGRAM_HASH_CHECK=true
   ```

2. Backend перезапущен с этой настройкой.

## Постоянное решение

### 1. Настройте домен в BotFather

**Это критически важно!** Без этого проверка хеша не будет работать правильно.

1. Откройте [@BotFather](https://t.me/BotFather) в Telegram
2. Отправьте команду `/setdomain`
3. Выберите вашего бота из списка
4. Введите домен **БЕЗ протокола**: `sybota.space`
5. Подтвердите

⚠️ **Важно:**
- Не указывайте `http://` или `https://`
- Не указывайте порт
- После изменения может потребоваться несколько минут для применения

### 2. После настройки домена

1. Удалите или закомментируйте строку в `backend/.env`:
   ```
   # SKIP_TELEGRAM_HASH_CHECK=true
   ```

2. Перезапустите backend:
   ```bash
   docker-compose restart backend
   ```

3. Проверка хеша должна работать правильно.

## Проверка

После настройки домена в BotFather попробуйте авторизоваться через Telegram. Если все настроено правильно, проверка хеша должна пройти успешно.

## Отладка

Если проблема сохраняется, проверьте логи:
```bash
docker-compose logs backend --tail 50 | grep "TELEGRAM AUTH DEBUG"
```

В логах будет видно:
- Какая `dataCheckString` формируется
- Какой хеш вычисляется
- Какой хеш получен от Telegram

